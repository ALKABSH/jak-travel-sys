# ุงูุนูุงูุงุช ุจูู ุฌุฏุงูู ูุงุนุฏุฉ ุงูุจูุงูุงุช (ERD) ูุน ุชูุฒูุน ุงูููุงู ูุงูุฃุฏูุงุฑ

## ุงูุฌุฏุงูู ุงูุฑุฆูุณูุฉ ูุงูุฃุฏูุงุฑ ูุงูููุงู:

### ๐ข agencies (ุงูููุงูุงุช)
- ุฌุฏูู ุฑุฆูุณู (ุนุงุฏุฉ ุณุฌู ูุงุญุฏ).
- [id] ููุชุงุญ ุฃุณุงุณู.
- **ููุงู ุงููููู ุงูุฑุฆูุณู:**
    - ุชุญูู ุดุงูู ูู ุงูููุงูุฉ ูุฎุฏูุงุชูุง
    - ุฅุฏุงุฑุฉ ุงูุณุจูููุงุก ูุงูุนููุงุก ุงูุชุงุจุนูู
    - ุชูููุฏ ุงูุชูุงุฑูุฑ ูุฅุนุฏุงุฏ ุงูุนุฑูุถ
    - ุฅุฏุงุฑุฉ ุงูุนููุงุช ูุงูุชุญูููุงุช

### ๐งโ๐ป users (ุงููุณุชุฎุฏููู)
- [id] ููุชุงุญ ุฃุณุงุณู.
- [agency_id] ููุชุงุญ ุฎุงุฑุฌู โ agencies.id
- [role] ูุญุฏุฏ ุงูุฏูุฑ (admin, agency, subagent, client)
- [parent_id] (ุงุฎุชูุงุฑู) ูุดูุฑ ุฅูู ุงููุณุชุฎุฏู ุงููุณุคูู (ููุณุจูููุงุก)
- **ููุงู ุงูุฃุฏูู:**
    - ุชุญูู ูุงูู ุจุงูุชุทุจูู ูููุฒุงุชู
    - ุฅุฏุงุฑุฉ ุฅุนุฏุงุฏุงุช ุงููุธุงู ุงูุนุงูุฉ
    - ุฅุฏุงุฑุฉ ูุชุนุฏูู ุตูุงุญูุงุช ุงููุณุชุฎุฏููู
- **ููุงู ุงูุนููู:**
    - ุงุณุชุนุฑุงุถ ุงูุฎุฏูุงุช ุงููุชุงุญุฉ
    - ุชูุฏูู ุทูุจุงุช ุฎุฏูุฉ ุฌุฏูุฏุฉ
    - ูุชุงุจุนุฉ ุญุงูุฉ ุงูุทูุจุงุช ุงููุงุฆูุฉ
    - ุงุณุชูุงู ุงูุนุฑูุถ ูุงูููุงููุฉ ุนูููุง
- **ููุงู ุงูุณุจูููู:**
    - ูููู ุฃู ูุถูู ุฎุฏูุงุช ุฎุงุตุฉ ุจู (ุชุนุชุจุฑ ุถูู ุฎุฏูุงุช ุงููููู ุงูุฑุฆูุณู)
    - ุชูุฏูู ุนุฑูุถ ุฃุณุนุงุฑ ููุฎุฏูุงุช
    - ูุชุงุจุนุฉ ุงูุทูุจุงุช ูุชุญุฏูุซูุง

### ๐งโ๐ง subagents (ุงูุณุจูููุงุก)
- ูู ูุณุชุฎุฏููู ูู users (role=subagent)
- [agency_id] โ agencies.id
- ุนูุงูุฉ N:N ูุน ุงูุฎุฏูุงุช ุนุจุฑ ุฌุฏูู ูุณูุท (service_subagent)
- **ููุงู ุงูุณุจูููู:**
    - ุฅุถุงูุฉ ุฎุฏูุงุช ุฎุงุตุฉ (ุชุธูุฑ ุถูู ุฎุฏูุงุช ุงููููู)
    - ุชูุฏูู ุนุฑูุถ ุฃุณุนุงุฑ
    - ูุชุงุจุนุฉ ูุชุญุฏูุซ ุงูุทูุจุงุช

### ๐ค clients (ุงูุนููุงุก)
- ูู ูุณุชุฎุฏููู ูู users (role=client)
- [agency_id] โ agencies.id
- **ููุงู ุงูุนููู:**
    - ุงุณุชุนุฑุงุถ ุงูุฎุฏูุงุช
    - ุชูุฏูู ุงูุทูุจุงุช
    - ูุชุงุจุนุฉ ุญุงูุฉ ุงูุทูุจุงุช
    - ุงุณุชูุงู ุงูุนุฑูุถ ูุงูููุงููุฉ ุนูููุง

### ๐งพ services (ุงูุฎุฏูุงุช)
- [id] ููุชุงุญ ุฃุณุงุณู
- [agency_id] โ agencies.id
- ุนูุงูุฉ N:N ูุน ุงูุณุจูููุงุก ุนุจุฑ ุฌุฏูู ูุณูุท (service_subagent)
- **ููุงุญุธุงุช:**
    - ูููู ูููููู ูุงูุณุจูููุงุก ุฅุฏุงุฑุฉ ุงูุฎุฏูุงุช ุญุณุจ ุงูุตูุงุญูุงุช

### ๐ฆ requests (ุงูุทูุจุงุช)
- [id] ููุชุงุญ ุฃุณุงุณู
- [user_id] โ users.id (ุงูุนููู)
- [agency_id] โ agencies.id
- [service_id] โ services.id
- **ููุงุญุธุงุช:**
    - ููุดุฆูุง ุงูุนููู ูุชุฏูุฑูุง ุงูููุงูุฉ ูุชูุฌููุง ููุณุจูููุงุก

### ๐ฐ quotes (ุงูุนุฑูุถ)
- [id] ููุชุงุญ ุฃุณุงุณู
- [request_id] โ requests.id
- [subagent_id] โ users.id (ุงูุณุจูููู)
- [currency_id] โ currencies.id
- [agency_id] โ agencies.id
- **ููุงุญุธุงุช:**
    - ููุดุฆูุง ุงูุณุจูููุงุก ูุชุฑุงุฌุนูุง ุงูููุงูุฉ ูุชุนุฑุถ ููุนููู

### ๐ณ payments (ุงููุฏููุนุงุช)
- [id] ููุชุงุญ ุฃุณุงุณู
- [user_id] โ users.id (ุงูุนููู)
- [quote_id] โ quotes.id
- [agency_id] โ agencies.id
- **ููุงุญุธุงุช:**
    - ุฌููุน ุงููุฏููุนุงุช ุจูู ุงูุนููู ูุงูููุงูุฉ ููุท

### ๐ฑ currencies (ุงูุนููุงุช)
- [id] ููุชุงุญ ุฃุณุงุณู
- ุชุณุชุฎุฏู ูู quotes, services, agencies
- **ููุงู ุงููููู:**
    - ุฅุฏุงุฑุฉ ุงูุนููุงุช ูุงูุชุญูููุงุช

---

## ุงูุฌุฏุงูู ุงููุณูุทุฉ (Pivot Tables)
- **service_subagent**
  - [service_id] โ services.id
  - [subagent_id] โ users.id
  - [custom_commission_rate] ูุณุจุฉ ุงูุนูููุฉ ุงููุฎุตุตุฉ
  - [is_active] ุญุงูุฉ ุงูุฑุจุท

---

## ููุฎุต ุงูุนูุงูุงุช (Foreign Keys)
- users.agency_id โ agencies.id
- users.parent_id โ users.id (ุงุฎุชูุงุฑู)
- requests.user_id โ users.id
- requests.agency_id โ agencies.id
- requests.service_id โ services.id
- quotes.request_id โ requests.id
- quotes.subagent_id โ users.id
- quotes.currency_id โ currencies.id
- quotes.agency_id โ agencies.id
- services.agency_id โ agencies.id
- payments.user_id โ users.id
- payments.quote_id โ quotes.id
- payments.agency_id โ agencies.id
- service_subagent.service_id โ services.id
- service_subagent.subagent_id โ users.id

---

## ููุงุญุธุงุช:
- ุฌููุน ุงูุนูููุงุช ุงููุงููุฉ ุจูู ุงูุนููู ูุงูููุงูุฉ ููุท.
- ุงูุณุจูููุงุก ูุง ูุฑูู ุจูุงูุงุช ุงูุนููู ูุจุงุดุฑุฉ.
- ุฌููุน ุงูุทูุจุงุช ูุงูุนุฑูุถ ุชูุฑ ุนุจุฑ ุงูููุงูุฉ.
- ุงูุนููุงุช ูุญุฏุฏูุง ุงูุณุจูููุงุก ูู ุงูุนุฑูุถุ ูุชุชุญูู ุงูููุงูุฉ ูู ุงูุนููุงุช ุงููุณููุญ ุจูุง.

---

ูุฐุง ุงูุชูุซูู ูุนูุณ ุจููุฉ ุงูุนูุงูุงุช ุงููุนููุฉ ูู ุงููุธุงู ููุณุงุนุฏ ูู ููู ุชุฏูู ุงูุจูุงูุงุช ูุงูุตูุงุญูุงุช ุจุฏูุฉ.
